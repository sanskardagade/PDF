/** Notice * This file contains works from many authors under various (but compatible) licenses. Please see core.txt for more information. **/
(function(){(window.wpCoreControlsBundle=window.wpCoreControlsBundle||[]).push([[13],{678:function(wa,ua,b){function la(){return!1}function na(aa,z,fa){if(!(z in w))return!0;z=w[z];for(var ea=0;ea<z.length;ea++){var ha=aa;var ba=z[ea];var qa=fa;if(ba.name in ha){var ka="",ma=!1;ha=ha[ba.name];switch(ba.type){case "s":ka="String";ma=Object(ia.isString)(ha);break;case "a":ka="Array";ma=Object(ia.isArray)(ha);break;case "n":ka="Number";ma=Object(ia.isNumber)(ha)&&Object(ia.isFinite)(ha);break;case "o":ka="Object",
ma=Object(ia.isObject)(ha)&&!Object(ia.isArray)(ha)}ma||qa.reject('Expected response field "'.concat(ba.name,'" to have type ').concat(ka));ba=ma}else qa.reject('Response missing field "'.concat(ba.name,'"')),ba=!1;if(!ba)return!1}return!0}function oa(aa){for(var z=0,fa=["locale","excelMaxAllowedCellCount","applyPageBreaksToSheet","excelDefaultCellBorderWidth","displayChangeTracking"];z<fa.length;z++){var ea=fa[z],ha=ea;ea=ea.charAt(0).toUpperCase()+ea.slice(1);aa[ha]&&(Object.defineProperty(aa,ea,
Object.getOwnPropertyDescriptor(aa,ha)),delete aa[ha])}return aa}b.r(ua);var ja=b(0),ia=b(1);b.n(ia);var ca=b(2);wa=b(49);var x=b(39),y=b(697),n=b(144),h=b(589),f=b(56),r=b(270),e=function(){function aa(){this.request=this.result=null;this.state=0;var z=this;z.promise=new Promise(function(fa,ea){z.resolve=function(){if(0===z.state||4===z.state)z.state=1,z.result=arguments[0],fa.apply(null,arguments)};z.reject=function(){if(0===z.state||4===z.state)z.state=2,ea.apply(null,arguments)}})}aa.prototype.mp=
function(){return 1===(this.state&1)};aa.prototype.rOa=function(){return 2===(this.state&2)};aa.prototype.jn=function(){return!this.rOa()&&!this.mp()};aa.prototype.JNa=function(){return 4===(this.state&4)};aa.prototype.g3=function(){this.state|=4};return aa}(),a=function(){function aa(){this.nB={};this.Wc=[]}aa.prototype.pop=function(){var z=this.Wc.pop();this.nB[z.key]=void 0;return z};aa.prototype.push=function(z,fa){fa={key:z,data:fa};this.Wc.push(fa);this.nB[z]=fa.data};aa.prototype.contains=
function(z){return!!this.nB[z]};aa.prototype.get=function(z){return this.nB[z]};aa.prototype.set=function(z,fa){var ea=this;this.nB[z]=fa;this.Wc.forEach(function(ha,ba){ha.key===z&&(ea.Wc[ba]=ha)})};aa.prototype.remove=function(z){var fa=this;this.nB[z]=void 0;this.Wc.forEach(function(ea,ha){ea.key===z&&fa.Wc.splice(ha,1)})};aa.prototype.length=function(){return this.Wc.length};return aa}(),w={pages:[{name:"pages",type:"a"}],pdf:[{name:"url",type:"s"}],docmod:[{name:"url",type:"s"},{name:"rID",type:"s"}],
health:[],tiles:[{name:"z",type:"n"},{name:"rID",type:"n"},{name:"tiles",type:"a"},{name:"size",type:"n"}],cAnnots:[{name:"annots",type:"a"}],annots:[{name:"url",type:"s"},{name:"name",type:"s"}],image:[{name:"url",type:"s"},{name:"name",type:"s"},{name:"p",type:"n"}],text:[{name:"url",type:"s"},{name:"name",type:"s"},{name:"p",type:"n"}],ApString2Xod:[{name:"url",type:"s"},{name:"rID",type:"s"}]};b=function(){function aa(z,fa,ea){var ha=this;this.T3=this.Zaa=!1;this.pk=this.GS=this.sD=this.Gg=this.YE=
this.Hu=this.XE=this.ys=null;this.Or=new e;this.lw=new e;this.AM=!1;this.ei=this.Kg=this.Lg=this.Qh=null;this.Fi=[];this.HN=[];this.cache={};this.timeStamp=0;this.jk=[];this.lj=[];this.xX=null;this.Iaa=!1;this.Vka=this.id=null;this.X_=this.Nea=la;this.zi=0;this.wZ=!1;this.mha=1;this.rn={};this.Lz=0;this.xC=new a;fa.endsWith("/")||(fa+="/");ea=ea||{};this.Zaa=ea.disableWebsockets||!1;this.T3=ea.singleServerMode||!1;null!=ea.customQueryParameters&&Object(f.b)("wvsQueryParameters",ea.customQueryParameters);
fa.endsWith("blackbox/")||(fa+="blackbox/");this.ys=ea.uploadData||null;this.sD=ea.uriData||null;this.XE=ea.cacheKey||null;if(this.Hu=ea.officeOptions||null)this.Hu=oa(this.Hu);this.Gg=ea.rasterizerOptions||null;this.YE=ea.cadOptions||null;this.Th=fa;this.VW=z;this.Zu(!0);this.mA=(new y.a(fa,null,this.Ym())).zGa(!this.Zaa,function(ba){ha.lRa(ba)},function(){return null},function(){ha.AM=!1},function(){ha.jWa()})}aa.prototype.FYa=function(z){this.Nea=z||la;this.X_=la};aa.prototype.cza=function(){this.jka();
return this.mA.Jw()};aa.prototype.jka=function(){Object(ja.c)(this,void 0,void 0,function(){return Object(ja.e)(this,function(){this.lw=new e;this.Or=new e;this.AM=!1;this.id=null;this.Iaa=!1;return[2]})})};aa.prototype.jWa=function(){this.Nea();this.jka();this.Qh&&(this.Qh.jn()?this.tk(this.Qh.request):this.Qh.mp()&&this.X_(this.Qh.result.url,"pdf")&&(this.Qh=null,this.gka()));this.ei&&this.ei.jn()&&this.tk(this.ei.request);this.Lg&&this.Lg.jn()?this.tk(this.Lg.request):this.Kg&&this.Kg.jn()&&this.oea();
var z;for(z=0;z<this.jk.length;z++)this.jk[z]&&(this.jk[z].jn()?this.tk(this.jk[z].request):this.jk[z].mp()&&this.X_(this.jk[z].result.url,"image")&&(this.jk[z]=null,this.ZQ(Object(ia.uniqueId)(),z)));for(z=0;z<this.lj.length;z++)this.lj[z]&&this.lj[z].jn()&&!this.lj[z].JNa()&&this.tk(this.lj[z].request);for(z=0;z<this.Fi.length;z++)this.Fi[z]&&this.Fi[z].jn()&&this.tk(this.Fi[z].request)};aa.prototype.EMa=function(){return this.AM?Promise.resolve():(this.AM=!0,this.timeStamp=Date.now(),this.mA.hP())};
aa.prototype.l2a=function(){var z=this,fa,ea,ha,ba,qa;return new Promise(function(ka,ma){if(z.ys)fa=new FormData,fa.append("file",z.ys.fileHandle,z.ys.fileHandle.name),z.Hu&&fa.append("officeOptions",JSON.stringify(z.Hu)),z.Gg&&fa.append("rasterizerOptions",JSON.stringify(z.Gg)),z.YE&&fa.append("cadOptions",z.YE.getJsonString()),z.XE&&fa.append("cacheKey",z.XE),ea=z.ys.loadCallback,ba="upload",ha=z.ys.extension;else if(z.sD)fa={uri:z.sD.uri,q8a:z.sD.shareId},fa=Object.keys(fa).map(function(sa){return"".concat(sa,
"=").concat(fa[sa]?encodeURIComponent(fa[sa]):"")}).join("&"),qa="application/x-www-form-urlencoded; charset=UTF-8",ea=z.sD.loadCallback,ba="url",ha=z.sD.extension;else{ka();return}var ra=new XMLHttpRequest,pa=Object(x.l)(z.Th,"AuxUpload");pa=Object(r.a)(pa,{type:ba,ext:ha});ra.open("POST",pa);ra.withCredentials=z.Ym();qa&&ra.setRequestHeader("Content-Type",qa);ra.addEventListener("load",function(){if(ra.readyState===ra.DONE&&200===ra.status){var sa=JSON.parse(ra.response);z.VW=sa.uri;ea(sa);ka(sa)}});
ra.addEventListener("error",function(){ma("".concat(ra.statusText," ").concat(JSON.stringify(ra)))});z.ys&&null!=z.ys.onProgress&&(ra.upload.onprogress=function(sa){z.ys.onProgress(sa)});ra.send(fa)})};aa.prototype.VVa=function(z){this.password=z||null;this.Or.mp()||(this.Or=new e,this.tk({t:"pages"}));return this.Or.promise};aa.prototype.EI=function(z){this.xX=z||null;this.Or.mp()||this.tk({t:"pages"});return this.Or.promise};aa.prototype.kF=function(z){z=Object.assign(z,{uri:encodeURIComponent(this.VW)});
this.xX&&(z.ext=this.xX);this.pk&&(z.c=this.pk);this.password&&(z.pswd=this.password);this.XE&&(z.cacheKey=this.XE);this.Hu&&(z.officeOptions=this.Hu);this.Gg&&(z.rastOptions=this.Gg);this.YE&&(z.cadOptions=this.YE.mImpl);return z};aa.prototype.fXa=function(){0<this.xC.length()&&10>=this.Lz&&this.gXa(this.xC.pop().data)};aa.prototype.hya=function(z){0<this.xC.length()&&this.xC.contains(z)&&this.xC.remove(z)};aa.prototype.tk=function(z){z=this.kF(z);this.mA.send(z)};aa.prototype.Rka=function(z,fa){10<
this.Lz?this.xC.push(z,fa):(this.Lz++,z=this.kF(fa),this.mA.send(z))};aa.prototype.gXa=function(z){this.Lz++;z=this.kF(z);this.mA.send(z)};aa.prototype.Jq=function(z){return z};aa.prototype.Mea=function(z){this.T3&&z?Object(ca.j)("Server failed health check. Single server mode ignoring check."):!this.a6a&&z&&3>=this.zi?(this.wZ=!0,this.mA.Jw()):3<this.zi&&(this.T3=!0)};aa.prototype.lRa=function(z){var fa=this,ea=z.data,ha=z.err,ba=z.t;switch(ba){case "upload":ha?this.m2a.reject(ha):this.m2a.resolve("Success");
break;case "pages":ha?this.Or.reject(ha):na(ea,ba,this.Or)&&this.Or.resolve(ea);break;case "config":if(ha)this.lw.reject(ha);else if(na(ea,ba,this.lw)){this.Mea(ea.unhealthy);ea.id&&(this.id=ea.id);if(ea.auth){var qa=Object(f.a)("wvsQueryParameters");qa.auth=ea.auth;Object(f.b)("wvsQueryParameters",qa)}ea.serverVersion&&(this.GS=ea.serverVersion,Object(ca.h)("[WebViewer Server] server version: ".concat(this.GS)));ea.serverID?(this.zi=ea.serverID===this.Vka&&this.wZ?this.zi+1:0,this.Vka=ea.serverID):
this.zi=0;this.wZ=!1;this.lw.resolve(ea)}break;case "health":ha?this.lw.reject(ha):na(ea,ba,this.lw)&&this.Mea(ea.unhealthy);break;case "pdf":ea.url=Object(r.a)("".concat(this.Th,"../").concat(encodeURI(ea.url)));ha?this.Qh.reject(ha):na(ea,ba,this.Qh)&&this.Qh.resolve(ea);break;case "ApString2Xod":ea.url=Object(r.a)("".concat(this.Th,"../data/").concat(encodeURI(ea.url)));ha?this.rn[ea.rID].reject(ha):na(ea,ba,this.rn[ea.rID])&&this.rn[ea.rID].resolve(ea);break;case "docmod":ea.url=Object(r.a)("".concat(this.Th,
"../").concat(encodeURI(ea.url)));ha?this.rn[ea.rID].reject(ha):na(ea,ba,this.Qh)&&this.rn[ea.rID].resolve(ea);break;case "xod":if(ha)this.Lg&&this.Lg.jn()&&this.Lg.reject(ha),this.Kg&&this.Kg.jn()&&this.Kg.reject(ha);else if(ea.notFound)ea.noCreate||this.Lg&&this.Lg.jn()&&this.Lg.resolve(ea),this.Kg&&this.Kg.jn()&&this.Kg.resolve(ea);else{ea.url&&(ea.url=Object(r.a)("".concat(this.Th,"../").concat(encodeURI(ea.url))));if(!this.Kg||this.Kg.mp())this.Kg=new e,this.Kg.request={t:"xod",noCreate:!0};
this.Lg||(this.Lg=new e,this.Lg.request={t:"xod"});this.Kg.resolve(ea);this.Lg.resolve(ea)}break;case "cAnnots":qa=this.ei;if(ha)qa.reject(ha);else if(na(ea,ba,qa)){qa.g3();var ka=[],ma=ea.annots;ea=function(xa){var Aa=ma[xa].s,Ca=ma[xa].e,Ga="".concat(ra.Th,"../").concat(encodeURI(ma[xa].xfdf)),za="true"===ma[xa].hasAppearance?Object(r.a)("".concat(Ga,".xodapp")):null,Ea=Object(ia.range)(Aa,Ca);ka[xa]={range:Ea,promise:new Promise(function(Ma,La){var Oa=new XMLHttpRequest;Oa.open("GET",Object(r.a)(Ga));
Oa.responseType="text";Oa.withCredentials=fa.Ym();Oa.addEventListener("load",function(){Oa.readyState===Oa.DONE&&200===Oa.status&&Ma({Ds:Oa.response,xq:za,range:Ea})});Oa.addEventListener("error",function(){La("".concat(Oa.statusText," ").concat(JSON.stringify(Oa)))});Oa.send()})}};var ra=this;for(ha=0;ha<ma.length;ha++)ea(ha);qa.resolve(ka)}break;case "annots":if(ha)this.ei.reject(ha);else if(na(ea,ba,this.ei)){this.ei.g3();var pa=new XMLHttpRequest;qa="".concat(this.Th,"../").concat(encodeURI(ea.url));
var sa=ea.hasAppearance?Object(r.a)("".concat(qa,".xodapp")):null;pa.open("GET",Object(r.a)(qa));pa.responseType="text";pa.withCredentials=this.Ym();pa.addEventListener("load",function(){pa.readyState===pa.DONE&&200===pa.status&&fa.ei.resolve({Ds:pa.response,xq:sa})});pa.addEventListener("error",function(){fa.ei.reject("".concat(pa.statusText," ").concat(JSON.stringify(pa)))});pa.send()}break;case "image":this.Lz--;var ta=this.jk[ea.p];ha?ta.promise.reject(ha):na(ea,ba,ta)&&(ta.result=ea,ta.result.url=
Object(r.a)("".concat(this.Th,"../").concat(encodeURI(ta.result.url))),ta.resolve(ta.result));break;case "tiles":this.Lz--;ta=ea.rID;qa=this.Fi[ta];this.Fi[ta]=null;this.HN.push(ta);if(ha)qa.reject(ha);else if(na(ea,ba,qa)){for(ha=0;ha<ea.tiles.length;ha++)ea.tiles[ha]=Object(r.a)("".concat(this.Th,"../").concat(encodeURI(ea.tiles[ha])));qa.resolve(ea)}break;case "text":ta=this.lj[ea.p];if(ha)ta.reject(ha);else if(na(ea,ba,ta)){ta.g3();var va=new XMLHttpRequest;ea=Object(r.a)("".concat(this.Th,"../").concat(encodeURI(ea.url)));
va.open("GET",ea);va.withCredentials=this.Ym();va.addEventListener("load",function(){va.readyState===va.DONE&&200===va.status&&(ta.result=JSON.parse(va.response),ta.resolve(ta.result))});va.addEventListener("error",function(xa){ta.reject("".concat(va.statusText," ").concat(JSON.stringify(xa)))});va.send()}break;case "progress":"loading"===ea.t&&this.trigger(n.a.Events.DOCUMENT_LOADING_PROGRESS,[ea.bytes,ea.total])}this.fXa();!ba&&z.echo&&z&&"apstring2xod"===z.echo.t&&(z=z.echo.reqID)&&(2<=parseInt(this.GS,
10)?this.rn[z].reject("Message unhandled by server"):this.rn[z].reject())};aa.prototype.mHa=function(){return Object(ja.c)(this,void 0,void 0,function(){return Object(ja.e)(this,function(z){switch(z.label){case 0:return[4,this.EMa()];case 1:return z.aa(),[2,this.lw.promise]}})})};aa.prototype.NGa=function(z){for(var fa=this,ea=new XMLHttpRequest,ha=Object(r.a)("".concat(this.Th,"aul"),{id:this.id}),ba=new FormData,qa={},ka=0;ka<z.body.length;ka++){var ma=z.body[ka];qa[ma.id]="".concat(ma.kV.w,";").concat(ma.kV.h);
ba.append(ma.id,ma.kV.dataString)}z={t:"apstring2xod",reqID:this.mha++,parts:qa};var ra=this.kF(z);ba.append("msg",JSON.stringify(ra));this.rn[ra.reqID]=new e;ea.open("POST",ha);ea.withCredentials=this.Ym;ha=new Promise(function(pa,sa){ea.onreadystatechange=function(){4===ea.readyState&&(200===ea.status?pa():sa("An error occurred while sending down appearance strings to the server"))}});ea.send(ba);return ha.then(function(){return fa.rn[ra.reqID].promise})};aa.prototype.iza=function(){var z=this.GS.split("-")[0].split("."),
fa=["1","5","9"];if(3!==z.length)throw Error("Invalid WVS version length.");if(3!==fa.length)throw Error("Invalid version length.");for(var ea=0;ea<z.length;++ea){if(fa.length===ea||z[ea]>fa[ea])return-1;if(z[ea]!==fa[ea])return 1}return 0};aa.prototype.iw=function(){return 0>=this.iza()};aa.prototype.TX=function(){this.ei||(this.ei=new e,this.iw()?this.ei.request={t:"cAnnots"}:this.ei.request={t:"annots"},this.tk(this.ei.request));return this.ei.promise};aa.prototype.ZQ=function(z,fa){this.jk[fa]||
(this.jk[fa]=new e,this.jk[fa].request={t:"image",p:fa},this.Rka(z,this.jk[fa].request));return this.jk[fa].promise};aa.prototype.WVa=function(z){this.lj[z]||(this.lj[z]=new e,this.lj[z].request={t:"text",p:z},this.tk(this.lj[z].request));return this.lj[z].promise};aa.prototype.XVa=function(z,fa,ea,ha,ba){var qa=this.Fi.length;this.HN.length&&(qa=this.HN.pop());this.Fi[qa]=new e;this.Fi[qa].request={t:"tiles",p:fa,z:ea,r:ha,size:ba,rID:qa};this.Rka(z,this.Fi[qa].request);return this.Fi[qa].promise};
aa.prototype.gka=function(){this.Qh||(this.Qh=new e,this.Qh.request={t:"pdf"},this.Iaa?this.Qh.resolve({url:this.VW}):this.tk(this.Qh.request));return this.Qh.promise};aa.prototype.oda=function(z){var fa=this,ea=new XMLHttpRequest,ha=Object(r.a)("".concat(this.Th,"aul"),{id:this.id}),ba=new FormData,qa={};z.annots&&(qa.annots="xfdf");z.watermark&&(qa.watermark="png");z.redactions&&(qa.redactions="redact");qa={t:"docmod",reqID:this.mha++,parts:qa};z.print&&(qa.print=!0);var ka=this.kF(qa);ba.append("msg",
JSON.stringify(ka));return Promise.all([z.annots,z.watermark,z.redactions].map(function(ma){return Promise.resolve(ma)})).then(function(ma){var ra=ma[0],pa=ma[1];ma=ma[2];ra&&ba.append("annots",ra);pa&&ba.append("watermark",pa);ma&&ba.append("redactions",ma);fa.rn[ka.reqID]=new e;ea.open("POST",ha);ea.withCredentials=fa.Ym;ra=new Promise(function(sa,ta){ea.onreadystatechange=function(){4===ea.readyState&&(200===ea.status?sa():ta("An error occurred while sending down annotation data to the server"))}});
ea.send(ba);return ra.then(function(){return fa.rn[ka.reqID].promise})})};aa.prototype.oea=function(){this.Kg||(this.Kg=new e,this.Kg.request={t:"xod",noCreate:!0},this.tk(this.Kg.request));return this.Kg.promise};aa.prototype.YVa=function(){this.Lg||(this.Lg=new e,this.Lg.request={t:"xod"},this.tk(this.Lg.request));return this.Lg.promise};aa.prototype.Su=function(){return!0};aa.prototype.request=function(){};aa.prototype.uja=function(){};aa.prototype.abort=function(){for(var z=0;z<this.Fi.length;z++)this.Fi[z]&&
(this.Fi[z].resolve(null),this.Fi[z]=null,this.HN.push(z));this.close()};aa.prototype.zR=function(z){this.pk=this.pk||{};this.pk.headers=z};aa.prototype.Zu=function(z){this.pk=this.pk||{};this.pk.internal=this.pk.internal||{};this.pk.internal.withCredentials=z};aa.prototype.Ym=function(){return this.pk&&this.pk.internal?this.pk.internal.withCredentials:null};aa.prototype.getFileData=function(){return Promise.reject()};return aa}();Object(wa.b)(b);Object(h.a)(b);Object(h.b)(b);ua["default"]=b},697:function(wa,
ua,b){var la=b(0),na=b(2),oa=b(39),ja=b(56),ia=b(270),ca=b(114),x=function(){function n(h,f,r,e,a,w){void 0===r&&(r=null);void 0===e&&(e=null);void 0===a&&(a=null);void 0===w&&(w=null);this.zZ=!1;this.zi=0;this.CH=8;this.xka=3E3;this.WR=!1;this.Y9=this.S2a(h);this.url=f?"".concat(this.Y9,"/").concat(f):"".concat(this.Y9,"/ws");this.BW=r;this.XH=e;this.iF=a;this.hka=w}n.prototype.S2a=function(h){var f=h.indexOf("://"),r="ws://";0>f?f=0:(5===f&&(r="wss://"),f+=3);var e=h.lastIndexOf("/");0>e&&(e=h.length);
return r+h.slice(f,e)};n.prototype.send=function(h){this.kv.readyState===WebSocket.CLOSED||this.zZ||this.kv.send(JSON.stringify(h))};n.prototype.hP=function(){return Object(la.c)(this,void 0,void 0,function(){var h,f=this;return Object(la.e)(this,function(){h=Object(ja.a)("wvsQueryParameters");h.bcid=Object(oa.m)(8);Object(ja.b)("wvsQueryParameters",h);return[2,new Promise(function(r,e){var a=Object(ia.a)(f.url);f.WR=!1;f.kv=new WebSocket(a);f.kv.onopen=function(){f.zZ=!1;f.zi=0;f.XH&&f.XH();r()};
f.kv.onerror=function(){f.zZ=!0};f.kv.onclose=function(w){w=w.code;f.iF&&f.iF();1E3!==w&&3E3!==w&&f.QLa(w,r,e)};f.kv.onmessage=function(w){w&&w.data&&(w=JSON.parse(w.data),w.hb?f.send({hb:!0}):w.end?close():f.BW(w))}})]})})};n.prototype.QLa=function(h,f,r){Object(la.c)(this,void 0,void 0,function(){var e=this;return Object(la.e)(this,function(){if(this.WR)return f(),[2];this.zi<this.CH?setTimeout(function(){e.WR?f():(e.zi++,Object(na.j)("Failed to connect to server with WebSocket close code ".concat(h,
". Reconnecting to WebViewer Server, attempt ").concat(e.zi," of ").concat(e.CH," ...")),e.hP().then(f).catch(r))},this.xka):r(ca.a);return[2]})})};n.prototype.Jw=function(){var h;void 0===h&&(h=!1);this.zi=0;this.WR=!0;h?this.kv.close(3E3):this.kv.close();return Promise.resolve()};return n}(),y=function(){function n(h,f,r,e,a,w,aa){void 0===e&&(e=null);void 0===a&&(a=null);void 0===w&&(w=null);void 0===aa&&(aa=null);this.zi=this.YQ=this.id=0;this.NG=!1;this.request=null;this.CH=8;this.xka=3E3;h=
this.mTa(h);this.url=f?"".concat(h,"/").concat(f,"pf"):"".concat(h,"/pf");this.wS=r;this.BW=e;this.XH=a;this.iF=w;this.hka=aa}n.prototype.mTa=function(h){var f=h.lastIndexOf("/");0>f&&(f=h.length);return h.slice(0,f)};n.prototype.iBa=function(h){h=h.split("\n");for(h[h.length-1]&&h.pop();0<h.length&&3>h[h.length-1].length;)"]"===h.pop()&&(this.id=0);0<h.length&&3>h[0].length&&h.shift();for(var f=0;f<h.length;++f)h[f].endsWith(",")&&(h[f]=h[f].substr(0,h[f].length-1));return h};n.prototype.wka=function(){return Object(la.c)(this,
void 0,void 0,function(){var h=this;return Object(la.e)(this,function(f){switch(f.label){case 0:return this.zi++<this.CH?[4,new Promise(function(r){return setTimeout(function(){h.hka();h.hP();r()},3E3)})]:[3,2];case 1:f.aa(),f.label=2;case 2:return[2]}})})};n.prototype.CTa=function(h){Object(la.c)(this,void 0,void 0,function(){var f,r;return Object(la.e)(this,function(e){switch(e.label){case 0:f=null,r=0,e.label=1;case 1:if(!(r<h.length))return[3,6];f=JSON.parse(h[r]);if(!f)return[3,5];if(!f.end)return[3,
2];close();return[3,5];case 2:if(!f.id||Number(f.id)===this.id)return[3,4];Object(na.j)("Reconnecting, new server detected");this.Jw();return[4,this.wka()];case 3:return e.aa(),[3,5];case 4:f.hb&&Number(f.id)===this.id?this.send({hb:!0}):this.NG||this.BW(f),e.label=5;case 5:return++r,[3,1];case 6:return[2]}})})};n.prototype.gRa=function(h){Object(la.c)(this,void 0,void 0,function(){var f,r,e;return Object(la.e)(this,function(a){switch(a.label){case 0:if(!(3<=h.readyState))return[3,2];try{f=h.responseText.length}catch(w){return Object(na.h)("caught exception"),
[2]}if(0<f)try{r=this.iBa(h.responseText),0===this.id&&0<r.length&&(e=JSON.parse(r.shift()),this.id=e.id,this.zi=0),this.CTa(r)}catch(w){}return this.NG?[3,2]:[4,this.Wba()];case 1:a.aa(),a.label=2;case 2:return[2]}})})};n.prototype.Wba=function(){return Object(la.c)(this,void 0,void 0,function(){var h=this;return Object(la.e)(this,function(){return[2,new Promise(function(f,r){function e(){return Object(la.c)(h,void 0,void 0,function(){return Object(la.e)(this,function(w){switch(w.label){case 0:r(),
this.Jw(),w.label=1;case 1:return this.NG&&this.zi<this.CH?[4,this.wka()]:[3,3];case 2:return w.aa(),[3,1];case 3:return[2]}})})}h.request=new XMLHttpRequest;h.request.withCredentials=h.wS;var a=Object(ia.a)(h.url,0!==h.id?{id:String(h.id),uc:String(h.YQ)}:{uc:String(h.YQ)});h.YQ++;h.request.open("GET",a,!0);h.request.setRequestHeader("Cache-Control","no-cache");h.request.setRequestHeader("X-Requested-With","XMLHttpRequest");h.request.onreadystatechange=function(){h.gRa(h.request)};h.request.addEventListener("error",
e);h.request.addEventListener("timeout",e);h.request.addEventListener("load",function(){h.XH&&h.XH();f()});h.request.send()})]})})};n.prototype.hP=function(){var h=Object(ja.a)("wvsQueryParameters");h.bcid=Object(oa.m)(8);Object(ja.b)("wvsQueryParameters",h);this.YQ=this.id=0;this.NG=!1;return this.Wba()};n.prototype.send=function(h){var f=this,r=new XMLHttpRequest;r.withCredentials=this.wS;var e=Object(ia.a)(this.url,{id:String(this.id)}),a=new FormData;a.append("data",JSON.stringify(h));r.addEventListener("error",
function(){f.Jw()});r.open("POST",e);r.setRequestHeader("X-Requested-With","XMLHttpRequest");r.send(a)};n.prototype.Jw=function(){this.id=0;this.NG=!0;this.iF&&this.iF();this.request.abort();return Promise.resolve()};return n}();wa=function(){function n(h,f,r){this.W$=h;this.target=f;this.wS=r}n.prototype.zGa=function(h,f,r,e,a){void 0===h&&(h=!0);void 0===f&&(f=null);void 0===r&&(r=null);void 0===e&&(e=null);void 0===a&&(a=null);return h?new x(this.W$,this.target,f,r,e,a):new y(this.W$,this.target,
this.wS,f,r,e,a)};return n}();ua.a=wa}}]);}).call(this || window)
